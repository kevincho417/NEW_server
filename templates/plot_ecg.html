<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real-Time ECG 12-Lead Display</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://cdn.plotly.com/2.8.3/plotly.min.js"></script>
</head>
<body>
    <h1>Real-Time ECG 12-Lead Display</h1>
    <!-- Create a div for each ECG lead -->
    <div id="lead-I" style="width:100%; height:250px;"></div>
    <div id="lead-II" style="width:100%; height:250px;"></div>
    <div id="lead-III" style="width:100%; height:250px;"></div>
    <div id="lead-aVR" style="width:100%; height:250px;"></div>
    <div id="lead-aVL" style="width:100%; height:250px;"></div>
    <div id="lead-aVF" style="width:100%; height:250px;"></div>
    <div id="lead-V1" style="width:100%; height:250px;"></div>
    <div id="lead-V2" style="width:100%; height:250px;"></div>
    <div id="lead-V3" style="width:100%; height:250px;"></div>
    <div id="lead-V4" style="width:100%; height:250px;"></div>
    <div id="lead-V5" style="width:100%; height:250px;"></div>
    <div id="lead-V6" style="width:100%; height:250px;"></div>

    <script type="text/javascript">
        function updatePlots() {
            fetch('/data')
                .then(response => response.json())
                .then(data => {
                    Object.entries(data).forEach(([leadId, waveform]) => {
                        const plotElementId = `lead-${leadId}`;
                        let plotElement = document.getElementById(plotElementId);
                        
                        // Configure the plot
                        const trace = {
                            x: Array.from({length: waveform.length}, (_, i) => i),
                            y: waveform,
                            type: 'scatter',
                            mode: 'lines',
                            name: `Lead ${leadId}`
                        };
                        
                        const layout = {
                            title: `ECG Lead ${leadId}`,
                            xaxis: {title: 'Sample Index'},
                            yaxis: {title: 'Amplitude'},
                            autosize: true
                        };
                        
                        Plotly.react(plotElementId, [trace], layout);
                    });
                })
                .catch(error => console.error('Error fetching ECG data:', error));
        }

        document.addEventListener('DOMContentLoaded', () => {
            updatePlots();  // Load initial data
            setInterval(updatePlots, 2000);  // Update the data every 2 seconds
        });
    </script>
</body>
</html>
